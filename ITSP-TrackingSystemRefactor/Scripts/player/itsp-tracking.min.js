var fixedtime = "0", iscomplete = !1, startDate = (new Date).getTime(); function getp(t) { return decodeURIComponent((RegExp("[?|&]" + t + "=([^&;]+?)(&|#|;|$)").exec(location.search) || [, ""])[1].replace(/\+/g, "%20")) || null } function StoreProgressStatus(t) { if (0 !== startDate && (fixedtime = ((new Date).getTime() - startDate) / 6e4), null != CCPlayer.TutorialID) var e = { action: "StoreASPProgressV2", TutorialStatus: t, TutorialTime: fixedtime, ProgressID: CCPlayer.ProgressID, CandidateID: CCPlayer.CandidateID, Version: CCPlayer.Version, CustomisationID: CCPlayer.CustomisationID, TutorialID: CCPlayer.TutorialID }; else e = { action: "StoreASPProgressNoSession", TutorialStatus: t, TutorialTime: fixedtime, ProgressID: CCPlayer.ProgressID, CandidateID: CCPlayer.CandidateID, Version: CCPlayer.Version, CustomisationID: CCPlayer.CustomisationID }; $.ajax({ type: "GET", url: CCPlayer.TrackURL, data: e, dataType: String }) } !function (t) { t.preload = function () { for (var e = "[object Array]" === Object.prototype.toString.call(arguments[0]) ? arguments[0] : arguments, s = [], o = e.length; o--;)s.push(t("<img />").attr("src", e[o])) } }(jQuery), function (t, e, s) { if (t.IsTracked = !0, t.CustomisationID = getp("CustomisationID"), t.ContentType = getp("type"), t.Version = getp("Version"), t.SectionID = getp("SectionID"), t.CandidateID = getp("CandidateID"), t.ProgressID = getp("ProgressID"), t.TutorialID = getp("TutorialID"), t.PLAThresh = getp("plathresh"), t.TrackURL = getp("TrackURL"), t.myscore = 0, t.wrongcount = 0, t.SelectionEnd = 0, t.SelectionStart = 0, null == t.TrackURL && (t.TrackURL = "https://www.dls.nhs.uk/v2/tracking/tracker"), void 0 === t.CustomisationID && (t.IsTracked = !1, t.CustomisationID = "1", t.ContentType = "learn", t.Version = "2", t.SectionID = "3", t.CandidateID = "4", t.ProgressID = "5", t.PLAThresh = "85"), t.MarkLearningComplete = function () { !0 === t.IsTracked ? (iscomplete = !0, StoreProgressStatus("2")) : alert("Learning complete") }, t.CloseLearning = function () { !0 === t.IsTracked ? (!1 === iscomplete && StoreProgressStatus("1"), window.parent.closeMpe()) : (alert("Close learning"), window.opener = window.self, window.close()) }, t.UpdateAssessmentScore = function (s, o) { t.AssessAttempted = !0; var n = !1; e.each(t.objson, function (t, e) { e.tutorialid == s && (o > 0 ? e.myscore = e.myscore + o : e.wrongcount = e.wrongcount + 1, n = !0) }), 0 == n && (o > 0 ? t.myscore = t.myscore + o : t.wrongcount = t.wrongcount + 1) }, t.SubmitDiagnosticOutcome = function () { if ("diag" === t.ContentType && !0 === t.AssessAttempted) { var s = JSON.stringify(t.objson), o = { action: "StoreDiagnosticJson", ProgressID: t.ProgressID, DiagnosticOutcome: s }; e.ajax({ type: "GET", url: t.TrackURL, data: o, dataType: String }), t.AssessAttempted = !1 } }, t.SubmitPLAssessOutcome = function (s) { if (!0 === t.AssessAttempted) { var o = { action: "StoreASPAssessNoSession", CandidateID: t.CandidateID, CustomisationID: t.CustomisationID, Version: t.Version, SectionID: t.SectionID, Score: parseInt(s, 10) }; e.ajax({ type: "GET", url: t.TrackURL, data: o, dataType: String }), t.AssessAttempted = !1 } }, "learn" !== t.ContentType) { t.AssessAttempted = !1, t.OutcomeAnimation = 0, objlist = (objlist = (objlist = getp("objlist")).replace("[", "")).replace("]", ""), t.ObjList = objlist.split(","), history.pushState(null, null, document.title), window.addEventListener("popstate", function () { history.pushState(null, null, document.title) }); var o = !1; "pl" === t.ContentType && (o = !0); var n = { action: "GetObjectiveArrayCC", CustomisationID: t.CustomisationID, SectionID: t.SectionID, IsPostLearning: o }; e.ajax({ type: "GET", url: t.TrackURL, data: n, success: function (s, o, n) { t.objson = s.objectives; var r = []; e.each(t.objson, function (s, o) { d = !0; var n = o.tutorialid; e.each(t.ObjList, function (t, e) { e == n && (d = !1) }), d && r.push(s) }), e.each(r.reverse(), function (e, s) { t.objson.splice(s, 1) }) }, error: function (t, e, s) { alert(t + "     " + s) } }) } }(window.CCPlayer = window.CCPlayer || {}, jQuery), jQuery.fn.reverse = [].reverse;